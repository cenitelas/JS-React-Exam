{"ast":null,"code":"var _jsxFileName = \"D:\\\\JS-React-Exam\\\\src\\\\ModalBook.js\";\nimport React from 'react';\nimport './ModalBook.css';\n\nclass ModalBook extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      close: props.close,\n      book: props.book,\n      books: props.books,\n      isNew: false,\n      error: false\n    };\n    this.onChangeText = this.onChangeText.bind(this);\n    this.saveBook = this.saveBook.bind(this);\n    this.deleteBook = this.deleteBook.bind(this);\n    this.addBook = this.addBook.bind(this);\n  }\n\n  componentDidMount() {\n    if (!this.state.book.id) this.setState({\n      isNew: true\n    });else this.setState({\n      isNew: false\n    });\n  }\n\n  onChangeText(e, item) {\n    this.setState({\n      error: false\n    });\n    var book = this.state.book;\n    var num = /^\\d+$/;\n    var word = /^\\D+$/;\n    if (item !== 'pages') if (item !== 'count') if (item !== 'year') if (word.test(e.target.value) === true) {\n      book[item] = e.target.value;\n      this.setState({\n        book: book\n      });\n    } else {\n      e.target.value = e.target.value.substring(0, e.target.value.length - 1);\n    }\n    if (item !== 'name') if (item !== 'author') if (item !== 'publish') if (num.test(e.target.value) === true) {\n      book[item] = e.target.value;\n      this.setState({\n        book: book\n      });\n    } else {\n      e.target.value = e.target.value.substring(0, e.target.value.length - 1);\n    }\n  }\n\n  saveBook(book) {\n    if (book.name) this.setState({\n      error: true\n    });\n    if (book.author) this.setState({\n      error: true\n    });\n    if (book.publish) this.setState({\n      error: true\n    });\n    if (book.pages) this.setState({\n      error: true\n    });\n    if (book.count) this.setState({\n      error: true\n    });\n\n    if (book.year) {\n      return;\n    }\n\n    if (book.id) {\n      var books = this.state.books;\n\n      for (let i = 0; i < books.length; i++) {\n        if (books[i].id === book.id) {\n          books[i] = book;\n        }\n      }\n\n      this.setState({\n        books: books\n      });\n      localStorage.removeItem(\"books\");\n      localStorage.setItem('books', JSON.stringify(this.state.books));\n      this.state.close();\n    } else {\n      this.addBook(book);\n    }\n  }\n\n  deleteBook(book) {\n    var books = this.state.books;\n\n    for (let i = 0; i < books.length; i++) {\n      if (books[i].id === book.id) {\n        books.splice(i, 1);\n      }\n    }\n\n    var carts = JSON.parse(localStorage.getItem('carts'));\n\n    for (let i = 0; i < carts.length; i++) {\n      if (carts[i].book.id === book.id) {\n        carts.splice(i, 1);\n      }\n    }\n\n    this.setState({\n      books: books\n    });\n    localStorage.removeItem(\"books\");\n    localStorage.setItem('books', JSON.stringify(books));\n    localStorage.removeItem(\"carts\");\n    localStorage.setItem('carts', JSON.stringify(carts));\n    this.state.close();\n  }\n\n  addBook(book) {\n    var books = this.state.books;\n    var maxId = 0;\n    books.forEach(function (item) {\n      if (maxId < parseInt(item.id)) maxId = parseInt(item.id);\n    });\n    book.id = '' + (maxId + 1);\n    books.push(book);\n    this.setState({\n      books: books\n    });\n    localStorage.removeItem(\"books\");\n    localStorage.setItem('books', JSON.stringify(books));\n    this.state.close();\n  }\n\n  render() {\n    const book = this.state.book;\n    return React.createElement(\"div\", {\n      className: \"modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"field-close\",\n      onClick: this.state.close,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"modal-context\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, this.state.isNew === false ? React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, \"EDIT BOOK\") : React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, \"CREATE BOOK\"), React.createElement(\"span\", {\n      onClick: this.state.close,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, \"X\")), React.createElement(\"div\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, \"Name:\"), React.createElement(\"input\", {\n      type: \"text\",\n      onChange: e => this.onChangeText(e, 'name'),\n      value: book.name,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, \"Author:\"), React.createElement(\"input\", {\n      type: \"text\",\n      onChange: e => this.onChangeText(e, 'author'),\n      value: book.author,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, \"Year:\"), React.createElement(\"input\", {\n      type: \"text\",\n      onChange: e => this.onChangeText(e, 'year'),\n      value: book.year,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, \"Publish:\"), React.createElement(\"input\", {\n      type: \"text\",\n      onChange: e => this.onChangeText(e, 'publish'),\n      value: book.publish,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, \"Pages:\"), React.createElement(\"input\", {\n      type: \"text\",\n      onChange: e => this.onChangeText(e, 'pages'),\n      value: book.pages,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, \"Count:\"), React.createElement(\"input\", {\n      type: \"text\",\n      onChange: e => this.onChangeText(e, 'count'),\n      value: book.count,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: () => this.saveBook(book),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, \"Save\"), this.state.isNew === false && React.createElement(\"button\", {\n      onClick: () => this.deleteBook(book),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, \"Delete\")))));\n  }\n\n}\n\nexport default ModalBook;","map":{"version":3,"sources":["D:\\JS-React-Exam\\src\\ModalBook.js"],"names":["React","ModalBook","Component","constructor","props","state","close","book","books","isNew","error","onChangeText","bind","saveBook","deleteBook","addBook","componentDidMount","id","setState","e","item","num","word","test","target","value","substring","length","name","author","publish","pages","count","year","i","localStorage","removeItem","setItem","JSON","stringify","splice","carts","parse","getItem","maxId","forEach","parseInt","push","render"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport './ModalBook.css';\r\n\r\n\r\nclass ModalBook extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state={\r\n        close:props.close,\r\n        book:props.book,\r\n        books:props.books,\r\n        isNew:false,\r\n        error:false\r\n    }\r\n    this.onChangeText=this.onChangeText.bind(this);\r\n    this.saveBook = this.saveBook.bind(this);\r\n    this.deleteBook = this.deleteBook.bind(this);\r\n    this.addBook = this.addBook.bind(this);\r\n  }\r\n\r\n  componentDidMount(){\r\n      if(!this.state.book.id)\r\n      this.setState({isNew:true})\r\n      else\r\n      this.setState({isNew:false})\r\n  }\r\n  onChangeText(e,item){\r\n    this.setState({error:false});\r\n    var book = this.state.book;\r\n    var num = /^\\d+$/; \r\n    var word = /^\\D+$/;\r\n    if(item!=='pages')\r\n    if(item!=='count')\r\n    if(item!=='year')\r\n    if(word.test(e.target.value)===true){\r\n      book[item]=e.target.value;\r\n      this.setState({book:book});\r\n    }else{\r\n      e.target.value=e.target.value.substring(0,e.target.value.length-1);\r\n    }\r\n    \r\n    if(item!=='name')\r\n    if(item!=='author')\r\n    if(item!=='publish')\r\n    if(num.test(e.target.value)===true){\r\n      book[item]=e.target.value;\r\n      this.setState({book:book});\r\n    }else{\r\n      e.target.value=e.target.value.substring(0,e.target.value.length-1);\r\n    } \r\n  }\r\n\r\n  saveBook(book){\r\n    if(book.name)\r\n      this.setState({error:true});\r\n    if(book.author)\r\n      this.setState({error:true});\r\n    if(book.publish)\r\n      this.setState({error:true});\r\n    if(book.pages)\r\n      this.setState({error:true});\r\n    if(book.count)\r\n      this.setState({error:true});\r\n    if(book.year){\r\n      return\r\n    }\r\n    if(book.id){\r\n    var books = this.state.books;\r\n    for(let i=0;i<books.length;i++){\r\n      if(books[i].id===book.id){\r\n        books[i]=book;\r\n      }\r\n    }\r\n    this.setState({books:books});\r\n    localStorage.removeItem(\"books\")\r\n    localStorage.setItem('books', JSON.stringify(this.state.books));\r\n    this.state.close();\r\n    }\r\n    else{\r\n    this.addBook(book);\r\n    }\r\n  }\r\n\r\n  deleteBook(book){\r\n    var books = this.state.books;\r\n    for(let i=0;i<books.length;i++){\r\n      if(books[i].id===book.id){\r\n        books.splice(i, 1);\r\n      }\r\n    }\r\n    var carts = JSON.parse(localStorage.getItem('carts'));\r\n    for(let i=0;i<carts.length;i++){\r\n      if(carts[i].book.id===book.id){\r\n        carts.splice(i, 1);\r\n      }\r\n    }\r\n    this.setState({books:books});\r\n    localStorage.removeItem(\"books\")\r\n    localStorage.setItem('books', JSON.stringify(books));\r\n    localStorage.removeItem(\"carts\")\r\n    localStorage.setItem('carts', JSON.stringify(carts));\r\n    this.state.close();\r\n  }\r\n\r\n  addBook(book){\r\n    var books = this.state.books;\r\n\r\n    var maxId = 0;\r\n    books.forEach(function(item){\r\n      if(maxId<parseInt(item.id))\r\n          maxId=parseInt(item.id);\r\n    });\r\n    book.id=''+(maxId+1);\r\n    books.push(book);\r\n    this.setState({books:books});\r\n    localStorage.removeItem(\"books\")\r\n    localStorage.setItem('books', JSON.stringify(books));\r\n    this.state.close();\r\n  }\r\n\r\n  render() {\r\n      const book = this.state.book;\r\n    return (\r\n      <div className=\"modal\">\r\n          <div className=\"field-close\" onClick={this.state.close}></div>\r\n          <div className=\"modal-context\">\r\n              <div className=\"header\">\r\n                  {this.state.isNew===false ? (\r\n                  <h3>EDIT BOOK</h3> \r\n                  ) : (\r\n                  <h3>CREATE BOOK</h3>\r\n                  )}\r\n                  <span onClick={this.state.close}>X</span>\r\n              </div>\r\n              <div className=\"content\">\r\n                <label>Name:</label>\r\n                <input type=\"text\" onChange={(e)=>this.onChangeText(e,'name')} value={book.name}/>\r\n                <label>Author:</label>\r\n                <input type=\"text\" onChange={(e)=>this.onChangeText(e,'author')} value={book.author}/>\r\n                <label>Year:</label>\r\n                <input type=\"text\" onChange={(e)=>this.onChangeText(e,'year')} value={book.year}/>\r\n                <label>Publish:</label>\r\n                <input type=\"text\" onChange={(e)=>this.onChangeText(e,'publish')} value={book.publish}/>\r\n                <label>Pages:</label>\r\n                <input type=\"text\" onChange={(e)=>this.onChangeText(e,'pages')} value={book.pages}/>\r\n                <label>Count:</label>\r\n                <input type=\"text\" onChange={(e)=>this.onChangeText(e,'count')} value={book.count}/>\r\n                <div>\r\n                    <button onClick={()=>this.saveBook(book)}>Save</button>\r\n                    {this.state.isNew===false &&\r\n                    <button onClick={()=>this.deleteBook(book)}>Delete</button>\r\n                    }\r\n                </div>\r\n              </div>\r\n          </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport default ModalBook;\r\n"]},"metadata":{},"sourceType":"module"}